# OneNote Clipper for VSCode

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„VSCodeæ‰©å±•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å°†ä»£ç ã€æ–‡ä»¶ã€å›¾ç‰‡å‘é€åˆ°Microsoft OneNoteã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **å‘é€é€‰ä¸­ä»£ç ç‰‡æ®µ** - é€‰ä¸­ä»£ç åä¸€é”®å‘é€
- âœ… **å‘é€æ•´ä¸ªæ–‡ä»¶** - å‘é€å®Œæ•´æ–‡ä»¶å†…å®¹
- âœ… **æ‰¹é‡å‘é€å¤šä¸ªæ–‡ä»¶** - ä¸€æ¬¡æ€§å‘é€å¤šä¸ªæ–‡ä»¶
- âœ… **å‘é€Markdown** - å°†Markdownæ¸²æŸ“ä¸ºHTMLåå‘é€
- âœ… **è‡ªå®šä¹‰é¡µé¢æ ‡é¢˜** - ä¸ºæ¯ä¸ªé¡µé¢è®¾ç½®æ ‡é¢˜
- âœ… **æ ‡ç­¾æ”¯æŒ** - ä¸ºé¡µé¢æ·»åŠ å½©è‰²æ ‡ç­¾
- âœ… **è®°ä½æœ€è¿‘ç›®æ ‡** - è‡ªåŠ¨è®°ä½ä¸Šæ¬¡ä½¿ç”¨çš„ç¬”è®°æœ¬/åˆ†åŒº

### é«˜çº§åŠŸèƒ½
- âœ… **æ‰¹é‡å‘é€æ¨¡å¼** - åˆå¹¶åˆ°ä¸€ä¸ªé¡µé¢æˆ–åˆ†å¼€å¤šä¸ªé¡µé¢
- âœ… **ä»£ç é«˜äº®ä¸»é¢˜** - 6ç§ä»£ç é«˜äº®ä¸»é¢˜å¯é€‰
- âœ… **æœ€è¿‘ç›®æ ‡å¿«é€Ÿé€‰æ‹©** - é»˜è®¤ä½¿ç”¨ä¸Šæ¬¡çš„ç¬”è®°æœ¬/åˆ†åŒº
- âœ… **Markdownæ¸²æŸ“** - æ”¯æŒåŸºç¡€Markdownè¯­æ³•
- âœ… **OAuth2è®¤è¯** - å®‰å…¨çš„Microsoftè´¦æˆ·ç™»å½•
- âœ… **å®Œå…¨æœ¬åœ°è¿è¡Œ** - ä¸ç»è¿‡ä»»ä½•ä¸­é—´æœåŠ¡å™¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

1. åœ¨VSCodeä¸­æŒ‰ `F5` å¯åŠ¨æ‰©å±•å¼€å‘ä¸»æœºè¿›è¡Œæµ‹è¯•
2. æˆ–è€…æ‰“åŒ…å®‰è£…ï¼š
   ```bash
   npm install
   npm run compile
   vsce package
   ```
   ç„¶ååœ¨VSCodeä¸­å®‰è£…ç”Ÿæˆçš„ `.vsix` æ–‡ä»¶

### é¦–æ¬¡ä½¿ç”¨

1. **ç™»å½•Microsoftè´¦æˆ·**
   - æŒ‰ `Ctrl+Shift+P` æ‰“å¼€å‘½ä»¤é¢æ¿
   - è¾“å…¥ "OneNote" å¹¶é€‰æ‹© "ç™»å½•Microsoftè´¦æˆ·"
   - åœ¨æµè§ˆå™¨ä¸­å®Œæˆæˆæƒ

2. **å‘é€å†…å®¹åˆ°OneNote**
   - **é€‰ä¸­ä»£ç **ï¼šé€‰ä¸­ä»£ç åæŒ‰ `Ctrl+Alt+O`
   - **æ•´ä¸ªæ–‡ä»¶**ï¼šæŒ‰ `Ctrl+Shift+Alt+O`
   - **æ‰¹é‡æ–‡ä»¶**ï¼šæŒ‰ `Ctrl+Shift+Alt+M`
   - **Markdownæ–‡ä»¶**ï¼šæ‰“å¼€.mdæ–‡ä»¶ â†’ å³é”® â†’ "å‘é€Markdownåˆ°OneNote"

## âŒ¨ï¸ å¿«æ·é”®

| åŠŸèƒ½ | Windows/Linux | Mac | è¯´æ˜ |
|------|---------------|-----|------|
| å‘é€é€‰ä¸­ä»£ç  | `Ctrl+Alt+O` | `Cmd+Alt+O` | éœ€è¦é€‰ä¸­ä»£ç  |
| å‘é€æ•´ä¸ªæ–‡ä»¶ | `Ctrl+Shift+Alt+O` | `Cmd+Shift+Alt+O` | å‘é€å½“å‰æ–‡ä»¶ |
| æ‰¹é‡å‘é€æ–‡ä»¶ | `Ctrl+Shift+Alt+M` | `Cmd+Shift+Alt+M` | é€‰æ‹©å¤šä¸ªæ–‡ä»¶å‘é€ |
| å‘é€Markdown | `Ctrl+Shift+Alt+I` | `Cmd+Shift+Alt+I` | å‘é€Markdownæ–‡ä»¶ |

## ğŸ“– è¯¦ç»†ä½¿ç”¨æŒ‡å—

### å‘é€ä»£ç ç‰‡æ®µ

1. åœ¨ç¼–è¾‘å™¨ä¸­é€‰ä¸­è¦å‘é€çš„ä»£ç 
2. æŒ‰ `Ctrl+Alt+O` æˆ–å³é”®é€‰æ‹© "å‘é€é€‰ä¸­å†…å®¹åˆ°OneNote"
3. è¾“å…¥é¡µé¢æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰
4. è¾“å…¥æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼Œå¯é€‰ï¼‰
5. é€‰æ‹©ç¬”è®°æœ¬å’Œåˆ†åŒº
6. å®Œæˆï¼ä»£ç å·²å‘é€åˆ°OneNote

### å‘é€æ•´ä¸ªæ–‡ä»¶

1. æ‰“å¼€è¦å‘é€çš„æ–‡ä»¶
2. æŒ‰ `Ctrl+Shift+Alt+O` æˆ–å³é”®é€‰æ‹© "å‘é€æ•´ä¸ªæ–‡ä»¶åˆ°OneNote"
3. è¾“å…¥é¡µé¢æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰
4. è¾“å…¥æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
5. é€‰æ‹©ç¬”è®°æœ¬å’Œåˆ†åŒº
6. å®Œæˆï¼æ–‡ä»¶å·²å‘é€åˆ°OneNote

### æ‰¹é‡å‘é€å¤šä¸ªæ–‡ä»¶

1. æŒ‰ `Ctrl+Shift+Alt+M` æˆ–ä»å‘½ä»¤é¢æ¿é€‰æ‹© "æ‰¹é‡å‘é€æ–‡ä»¶åˆ°OneNote"
2. åœ¨å¼¹å‡ºçš„æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ä¸­é€‰æ‹©å¤šä¸ªæ–‡ä»¶ï¼ˆæŒ‰ä½Ctrlæˆ–Shiftå¤šé€‰ï¼‰
3. è¾“å…¥æ‰¹é‡æ ‡é¢˜å‰ç¼€ï¼ˆå¯é€‰ï¼‰
4. é€‰æ‹©å‘é€æ–¹å¼ï¼š
   - **åˆå¹¶åˆ°ä¸€ä¸ªé¡µé¢**ï¼šæ‰€æœ‰æ–‡ä»¶å†…å®¹åˆå¹¶åˆ°ä¸€ä¸ªOneNoteé¡µé¢
   - **åˆ†å¼€å¤šä¸ªé¡µé¢**ï¼šæ¯ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„OneNoteé¡µé¢
5. é€‰æ‹©ç¬”è®°æœ¬å’Œåˆ†åŒº
6. å®Œæˆï¼æ–‡ä»¶å·²æ‰¹é‡å‘é€åˆ°OneNote

### å‘é€Markdownæ–‡ä»¶

å°†Markdownæ–‡ä»¶æ¸²æŸ“ä¸ºHTMLåå‘é€åˆ°OneNoteï¼Œä¿æŒæ ¼å¼å’Œæ ·å¼ã€‚ä½¿ç”¨å¼ºå¤§çš„ [markdown-it](https://github.com/markdown-it/markdown-it) æ¸²æŸ“å¼•æ“ï¼Œæ”¯æŒå®Œæ•´çš„Markdownè¯­æ³•ã€‚

#### æ–¹å¼1ï¼šå³é”®èœå•ï¼ˆæ¨èï¼‰
1. æ‰“å¼€è¦å‘é€çš„Markdownæ–‡ä»¶ï¼ˆ.md æˆ– .markdownï¼‰
2. åœ¨ç¼–è¾‘å™¨ä¸­å³é”®ç‚¹å‡»
3. é€‰æ‹© "å‘é€Markdownåˆ°OneNote"
4. è¾“å…¥é¡µé¢æ ‡é¢˜ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸ºæ–‡ä»¶åï¼‰
5. è¾“å…¥æ ‡ç­¾ï¼ˆå¯é€‰ï¼Œç”¨é€—å·åˆ†éš”ï¼‰
6. é€‰æ‹©ç¬”è®°æœ¬å’Œåˆ†åŒº
7. å®Œæˆï¼Markdownå·²æ¸²æŸ“å¹¶å‘é€åˆ°OneNote

#### æ–¹å¼2ï¼šå‘½ä»¤é¢æ¿
1. æ‰“å¼€Markdownæ–‡ä»¶
2. æŒ‰ `Ctrl+Shift+P` æ‰“å¼€å‘½ä»¤é¢æ¿
3. è¾“å…¥ "OneNote" å¹¶é€‰æ‹© "å‘é€Markdownåˆ°OneNote"
4. è¾“å…¥é¡µé¢æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰
5. è¾“å…¥æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
6. é€‰æ‹©ç¬”è®°æœ¬å’Œåˆ†åŒº
7. å®Œæˆï¼

#### æ–¹å¼3ï¼šå¿«æ·é”®
1. æ‰“å¼€Markdownæ–‡ä»¶
2. æŒ‰ `Ctrl+Shift+Alt+I`
3. è¾“å…¥é¡µé¢æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰
4. è¾“å…¥æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
5. é€‰æ‹©ç¬”è®°æœ¬å’Œåˆ†åŒº
6. å®Œæˆï¼

**æ”¯æŒçš„Markdownè¯­æ³•**ï¼ˆä½¿ç”¨markdown-itæ¸²æŸ“å¼•æ“ï¼‰ï¼š
- âœ… æ ‡é¢˜ï¼ˆ#ã€##ã€###ï¼Œæ”¯æŒå¤šçº§ï¼‰
- âœ… ç²—ä½“ï¼ˆ**text**ï¼‰å’Œæ–œä½“ï¼ˆ*text*ï¼‰
- âœ… è¡Œå†…ä»£ç ï¼ˆ`code`ï¼‰å’Œä»£ç å—ï¼ˆ```code```ï¼Œæ”¯æŒè¯­æ³•é«˜äº®ï¼‰
- âœ… é“¾æ¥ï¼ˆ[text](url)ï¼‰å’Œå›¾ç‰‡ï¼ˆ![alt](url)ï¼‰
- âœ… åˆ—è¡¨ï¼ˆ* itemã€- itemã€1. itemï¼Œæ”¯æŒåµŒå¥—ï¼‰
- âœ… å¼•ç”¨å—ï¼ˆ> quoteï¼‰
- âœ… æ°´å¹³çº¿ï¼ˆ---ï¼‰
- âœ… è¡¨æ ¼ï¼ˆ| Header | Header |ï¼‰
- âœ… åˆ é™¤çº¿ï¼ˆ~~text~~ï¼‰
- âœ… ä»»åŠ¡åˆ—è¡¨ï¼ˆ- [x] taskï¼‰
- âœ… æ‰€æœ‰HTMLæ ‡ç­¾ï¼ˆå¦‚æœå¯ç”¨ï¼‰

**æ¸²æŸ“ç‰¹æ€§**ï¼š
- ç¬¦åˆCommonMarkè§„èŒƒ
- æ”¯æŒè¡¨æ ¼ã€ä»»åŠ¡åˆ—è¡¨ç­‰æ‰©å±•è¯­æ³•
- ä»£ç å—æ”¯æŒè¯­æ³•é«˜äº®
- è‡ªåŠ¨è½¬æ¢URLä¸ºé“¾æ¥
- æ™ºèƒ½æ’ç‰ˆï¼ˆå¼•å·ã€è¿å­—ç¬¦ç­‰ï¼‰

### æ·»åŠ æ ‡ç­¾

åœ¨å‘é€å†…å®¹æ—¶ï¼Œå¯ä»¥åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ï¼Œä¾‹å¦‚ï¼š
```
é‡è¦,å¾…åŠ,ä»£ç ç‰‡æ®µ,APIæ–‡æ¡£
```

æ ‡ç­¾ä¼šä»¥å½©è‰²æ ·å¼æ˜¾ç¤ºåœ¨OneNoteé¡µé¢çš„åº•éƒ¨ï¼Œæ–¹ä¾¿åˆ†ç±»å’ŒæŸ¥æ‰¾ã€‚

### ä½¿ç”¨æœ€è¿‘çš„ç›®æ ‡

æ‰©å±•ä¼šè‡ªåŠ¨è®°ä½ä½ ä¸Šæ¬¡ä½¿ç”¨çš„ç¬”è®°æœ¬å’Œåˆ†åŒºï¼š

1. å½“ä½ å‘é€å†…å®¹æ—¶ï¼Œä¼šæ˜¾ç¤º "æœ€è¿‘ä½¿ç”¨: ç¬”è®°æœ¬å > åˆ†åŒºå" çš„é€‰é¡¹
2. ç›´æ¥æŒ‰ **Enter** æˆ–ç‚¹å‡»è¯¥é€‰é¡¹ï¼Œå³å¯å¿«é€Ÿä½¿ç”¨ä¸Šæ¬¡çš„ç›®æ ‡
3. æŒ‰ **ESC** æˆ–é€‰æ‹© "é€‰æ‹©æ–°çš„ç›®æ ‡"ï¼Œå¯ä»¥é‡æ–°é€‰æ‹©

è¿™ä¸ªåŠŸèƒ½å¯ä»¥å¤§å¤§æé«˜æ•ˆç‡ï¼Œé¿å…é‡å¤é€‰æ‹©ç›¸åŒçš„ç¬”è®°æœ¬å’Œåˆ†åŒºã€‚

### ä»£ç é«˜äº®ä¸»é¢˜

åœ¨VSCodeè®¾ç½®ä¸­é…ç½®ä»£ç é«˜äº®ä¸»é¢˜ï¼š

```json
{
  "onenote.codeHighlightTheme": "monokai"
}
```

å¯é€‰ä¸»é¢˜ï¼š
- `default` - é»˜è®¤ä¸»é¢˜
- `github` - GitHubé£æ ¼
- `monokai` - Monokaiæ·±è‰²ä¸»é¢˜
- `vs-dark` - VS Codeæ·±è‰²ä¸»é¢˜
- `vs-light` - VS Codeæµ…è‰²ä¸»é¢˜
- `atom-one-dark` - Atom One Darkä¸»é¢˜

## âš™ï¸ é…ç½®é€‰é¡¹

åœ¨VSCodeè®¾ç½®ä¸­æœç´¢ "OneNote" è¿›è¡Œé…ç½®ï¼š

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `onenote.clientId` | string | å…¬å…±Client ID | Azureåº”ç”¨Client IDï¼ˆé€šå¸¸ä¸éœ€è¦ä¿®æ”¹ï¼‰ |
| `onenote.defaultNotebook` | string | "" | é»˜è®¤ç¬”è®°æœ¬åç§° |
| `onenote.defaultSection` | string | "" | é»˜è®¤åˆ†åŒºåç§° |
| `onenote.codeHighlightTheme` | string | "default" | ä»£ç é«˜äº®ä¸»é¢˜ |
| `onenote.enableTags` | boolean | true | å‘é€æ—¶æ˜¯å¦å¯ç”¨æ ‡ç­¾è¾“å…¥ï¼ˆå¦‚æœç¦ç”¨ï¼Œå°†è·³è¿‡æ ‡ç­¾è¾“å…¥æ­¥éª¤ï¼‰ |
| `onenote.createNewPage` | boolean | true | æ˜¯å¦åˆ›å»ºæ–°é¡µé¢ |

## ğŸ”’ éšç§ä¸å®‰å…¨

- **å®Œå…¨æœ¬åœ°è¿è¡Œ**ï¼šæ‰€æœ‰æ•°æ®ç›´æ¥ä¼ è¾“åˆ°Microsoft OneNoteï¼Œä¸ç»è¿‡ä»»ä½•ç¬¬ä¸‰æ–¹æœåŠ¡å™¨
- **OAuth2è®¤è¯**ï¼šä½¿ç”¨å®‰å…¨çš„PKCEè®¤è¯æµç¨‹ï¼Œä¸éœ€è¦client_secret
- **æ— æ•°æ®æ”¶é›†**ï¼šä¸æ”¶é›†ä»»ä½•ç”¨æˆ·æ•°æ®æˆ–é¥æµ‹ä¿¡æ¯
- **ä»¤ç‰Œè‡ªåŠ¨åˆ·æ–°**ï¼šè®¿é—®ä»¤ç‰Œè¿‡æœŸåè‡ªåŠ¨åˆ·æ–°ï¼Œæ— éœ€é‡å¤ç™»å½•

## ğŸ› ï¸ å¼€å‘è¯´æ˜

### åˆ›å»ºAzureåº”ç”¨ï¼ˆå¼€å‘è€…ï¼‰

å¦‚æœä½ è¦è‡ªå·±æ„å»ºå’Œå‘å¸ƒè¿™ä¸ªæ‰©å±•ï¼Œéœ€è¦åœ¨Azure Portalåˆ›å»ºåº”ç”¨ï¼š

1. è®¿é—® [Azure Portal](https://portal.azure.com/)
2. æ³¨å†Œæ–°åº”ç”¨ï¼š
   - Name: `OneNote Clipper Public`
   - Supported account types: `Accounts in any organizational directory and personal Microsoft accounts`
   - Redirect URI: `Mobile and desktop applications` â†’ `http://localhost:8080/callback`
3. åœ¨ "Authentication" ä¸­å¯ç”¨ "Allow public client flows"
4. åœ¨ "API permissions" ä¸­æ·»åŠ :
   - `Notes.ReadWrite`
   - `offline_access`
5. å¤åˆ¶ "Application (client) ID" å¹¶æ›´æ–°åˆ° `src/config.ts`

### ç¼–è¯‘

```bash
npm install
npm run compile
```

### æ‰“åŒ…

```bash
npm install -g @vscode/vsce
vsce package
```

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ› æ•…éšœæ’é™¤

### ç™»å½•å¤±è´¥

**é—®é¢˜**ï¼š`AADSTS70002: The provided request must include a 'client_secret'`

**åŸå› **ï¼šAzureåº”ç”¨æ²¡æœ‰æ­£ç¡®é…ç½®ä¸ºå…¬å…±å®¢æˆ·ç«¯

**è§£å†³**ï¼š
1. åœ¨Azure Portalä¸­æ‰“å¼€åº”ç”¨
2. è¿›å…¥ "Authentication"
3. å‹¾é€‰ "Allow public client flows"
4. ç¡®ä¿ "Platform configurations" ä¸­æœ‰ "Mobile and desktop applications"
5. ç­‰å¾…2-3åˆ†é’Ÿåé‡è¯•

### è·å–ç¬”è®°æœ¬å¤±è´¥

**é—®é¢˜**ï¼š`Could not find a property named 'name'`

**åŸå› **ï¼šOneNote APIä½¿ç”¨ `displayName` è€Œä¸æ˜¯ `name`

**è§£å†³**ï¼šæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬

### å›¾ç‰‡å‘é€å¤±è´¥

**é—®é¢˜**ï¼š`æ— æ³•è¯»å–å›¾ç‰‡æ–‡ä»¶`

**åŸå› **ï¼šå›¾ç‰‡æ–‡ä»¶è·¯å¾„é”™è¯¯æˆ–æ–‡ä»¶æŸå

**è§£å†³**ï¼šç¡®ä¿å›¾ç‰‡æ–‡ä»¶å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·åœ¨GitHubæäº¤Issueã€‚

---

**äº«å—ä½¿ç”¨ OneNote Clipper å§ï¼** ğŸ‰
